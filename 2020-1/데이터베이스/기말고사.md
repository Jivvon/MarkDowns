## 용어 정리

Data redundancy : 데이터 중복

Integrate : 통합

Operational Data : 운영 데이터

1. Serializability : 직렬성

   ​	각각의 트랜잭션이 순차적으로 실행되는 것

2. Concurrency : 동시성

   ​	트랜잭션을 구성하는 각각의 쿼리문들이 트랜잭션의 순서에 상관없이 동시에 실행되는 것

4. **serial processing : 순차처리 프로세싱**

4. **concurrent processing : 동시처리 프로세싱**

5. **transaction : 트랜잭션**

   ​	**데이터베이스 응용프로그램에서 하나의 논리적 기능을 수행하는 연산자들의 모임**

6. object

   ​	데이터와 관련된 동작을 모두 포함한 개념

7. **database instance**

   ​	**특정한 순간 데이터 베이스에 저장되어 있는 정보의 모임**

8. **relation**

   ​	테이블. 고유한 이름을 가진 여러 개의 열로 구성된다.

9. **ACID**

   ​	데이터의 유효성을 보장하기 위한, 트랜잭션의 특징들의 앞글자를 딴 단어로,

   ​	Atomicity(원자성), Consistency(일관성), Isolation(고립성), Durability(지속성).

   - **Atomicity 원자성 : 트랜잭션 전체가 수행되든지 아니면 아무것도 수행되지 않는 것**
   - Consistency 일관성 : 트랜잭션 작업이 시작되기 전에 데이터베이스 상태가 일관된 상태였다면, 종료된 후에도 일관성 있는 데이터베이스 상태를 유지해야 한다
   - Isolation 고립성 : 트랜잭션 작업 수행 중에는 다른 트랜잭션에 영향을 주어서도, 받아서도 안 된다
   - Durability 지속성 : 트랜잭션이 성공하였다면 그 결과는 영구적으로 데이터베이스에 저장되어야 한다

10. Isolation Level

   1. Read Uncommited : 트랜잭션이 끝나지 않은 상황에서 각기 다른 트랜잭션이 변경한 내용에 대한 조회가 가능하다.
   2. Read Committed : 조회 시 데이터에 대한 shared lock이 된다.
   3. Repeatable Read : 트랙잭션이 범위 내에서 조회한 데이터의 일관성을 보장해준다.
   4. Serializable : 모든 동작이 직렬화되어 작동한다.

11. **authorization 권한**

    ​	데이터 베이스의 데이터에 대해서 사용자들마다 접근을 다르게 하고 싶을 때 이러한 차별을 권한이라 한다.

12. **deadlock**

    ​	두 개 이상의 트랜잭션들이 서로 상대방이 보유하고 있는 lock을 요청하면서 기다리고 있는 상태

13. **record**

   ​	파일을 엑세스할 때 실제로 읽고 쓰는 단위로써 사용되는 데이터 단위

14. **view**

    ​	사용자에게 접근이 허용된 자료만을 제한적으로 보여주기 위해 하나 이상의 기본 테이블로부터 유도된, 이름을 가지는 가상 테이블이다.

15. **non procedural language 비절차적 언어, 선언적 언어**

    ​	어떤 데이터를 필요한지만 명시하고 데이터를 구하는 방법은 명시하지 않음. 

16. **union compatible 합집합 호환**

    ​	연산하려는 두 릴레이션은 에트리뷰트 수와 해당 에트리뷰트의 도메인이 같아야 한다. (합집합, 교집합)

17. **referential integrity 참조 무결성**

    ​	주어진 속성 집합에 대한 릴레이션의 한 값이 다른 릴레이션에 대한 속성 집합의 값으로 반드시 나타나야 하는 조건.

18. **metadata 메타데이터 : 데이터를 위한 데이터**

19. **predicate 프레디키트**

    ​	셀렉션 조건, 임의의 에트리뷰트와 상수, 비교 연산자, 부울 연산자를 포함할 수 있다.

> ###### file processing과 DBMS processing의 차이점
>
> 파일처리 시스템은 통상 운영체제에 의해 지원된다. 시스템에서 영속적 레코드가 여러가지 서로 다른 파일들에 저장되는 경우가 생기는데 레코드를 검색하거나 새로 입력할 때 파일에 따라 여러가지 프로그램들이 서로 다르게 작성되어야 함을 의미
>
> DBMS는 서로 관련이 있는 데이터의 모임과 그 데이터에 접근하기 위한 프로그램의 집합으로 구성

![스크린샷 2020-06-19 오전 2.30.22](/Users/jiwon/Library/Application Support/typora-user-images/스크린샷 2020-06-19 오전 2.30.22.png)

### DBMS 시스템 구성

데이터베이스 관리 시스템(DBMS)은 사용자와 데이터베이스 사이에 위치하여 데이터베이스를 관리하고 

사용자의 요구에 따라 데이터베이스에 대한 연산을 수행해 정보를 생성해 주는 소프트웨어이다.

1. 외부 스키마
2. 개념 스키마 - 논리적 데이터 독립성
3. 내부 스키마 - 물리적 데이터 독립성

### 데이터 독립성

데이터의 논리적 구조나 물리적 구조에 응용 프로그램이 영향을 받지 않는 성질을 말한다.

- 논리적 데이터 독립성
  - 개념 스키마가 변경되어도 외부 스키마에는 영향을 미치지 않도록 지원
- 물리적 데이터 독립성
  - 내부 스키마가 변경되어도 개념/외부 스키마가 영향을 받지 않도록 지원

### key

1. **foreign key 외래키**

   ​	테이블이 다른 테이블의 데이터를 참조하여 테이블간의 관계를 연결하는 것이다.

   ​	다른 테이블의 데이터를 참조할 때 없는 값을 참조할 수 없도록 제약을 주는 것이다

2. **candidate key 후보키**

   ​	각 행을 유일하게 식별할 수 있는 최소한의 속성들의 집합이다. 후보키는 기본키가 될 수 있는 후보들이며 유일성과 최소성을 동시에 만족해야한다.

3. super key 슈퍼키

   ​	각 행을 유일하게 식별할 수 있는 하나 또는 그 이상의 속성들의 집합. 유일성만 만족하면 된다.

4. primary key 기본키

   ​	후보키들 중에서 하나를 선택한 키로 최소성과 유일성을 만족하는 속성이다.

5. alternate key 대체키

   ​	기본키로 선정되지 않은 후보키


## 관계 데이터 모델에서 지원하는 정형적인 언어
- relational calculus 관계 해석	(SQL)

    ​	원하는 데이터만 명시하고 질의를 어떻게 수행할 것인가는 명시하지 않는 선언적인 언어

- relational algebra 관계 대수	

    ​	어떻게 질의를 수행할 것인가를 명시하는 절차적 언어
    
    - 필수 연산자
      - σ : Selection. 셀렉션 조건을 만족하는 릴레이션의 투플을 출력
      - π : Projection. 릴레이션에서 선택된 속성을 출력. 중복된 투플은 제거.
      - 합집합. 두 릴레이션의 투플에 대해 합집합 수행
      - 차집합. 두 릴레이션의 투플에 대해 차집합 수행
      - x : 카티션곱. 두 릴레이션으로부터 가능한 모든 투플의 쌍을 출력.
    - 편의를 위해 유도된 연산자
      - 교집합, 조인(세타, 동등, 자연, 세미), 디비전

<img src="/Users/jiwon/Library/Application Support/typora-user-images/스크린샷 2020-06-18 오후 11.07.54.png" alt="스크린샷 2020-06-18 오후 11.07.54" style="zoom:50%;" />

![스크린샷 2020-06-18 오후 11.09.40](/Users/jiwon/Library/Application Support/typora-user-images/스크린샷 2020-06-18 오후 11.09.40.png)

<img src="/Users/jiwon/Library/Application Support/typora-user-images/스크린샷 2020-06-18 오후 11.25.48.png" alt="스크린샷 2020-06-18 오후 11.25.48" style="zoom:80%;" />

자연조인은 \*로 가능


>2. 학생 릴레이션에서 나이가 30보다 많고 성별이 “남”인 투플을 찾아라.
>① 관계대수 : σ나이>30∧성별=“남”(학생)
>② 관계해석:
>  {t|t∈학생∧t[나이]>30∧t[성별]=“남”}
>③ SQL : 
>  SELECT * 
>  FROM 학생 
>  WHERE 나이>30 AND 성별=‘남’;

>4. 대출, 고객 릴레이션에서 “혜화” 지점에 대출이 있는 모든 고객들의 이름을 찾아라.
>① 관계대수 : π이름((σ지점명=“혜화”(대출))⋈n고객)
>② 관계해석 : {t|∃s∈고객(t[이름]=s[이름]∧∃u∈대출
> (u[대출번호]=s[대출번호]∧u[지점명]=“혜화”))}
>③ SQL : 
> SELECT 고객.이름 
> FROM 고객, 대출 
> WHERE 고객.대출번호=대출.대출번호 
>​     AND 대출.지점명=‘혜화’;

>5. 생산품 릴레이션에서 판매가가 8,000원을 초과하는 모든 생산품코드를 찾아라
>① 관계대수 : π생산품코드(σ판매가>8000(생산품))
>② 관계해석 : 
>{t|∃s∈생산품(t[생산품코드]=s[생산품코드]∧s[판매가]>8000)}
>③ SQL : 
>  SELECT 생산품코드 
>  FROM 생산품 
>  WHERE 판매가>8000;



## 동시성 제어

여러 사용자들이 다수의 트랜잭션들을 동시에 수행하는 환경에서 트랜잭션들 간의 간섭이 생기지 않도록 하여 부정확한 결과를 생성하지 않기 위해 필요하다.

##### 연산

`연산은 주기억 장치의 버퍼 기준으로 생각하면 된다`

- Input(X) : X를 포함하는 블록을 주기억 장치의 버퍼로 읽어들임
- Output(X) : 주기억 장치의 X를 포함하는 블록을 디스크에 기록함
- Read(X), read_item(X) : 주기억 장치 버퍼에서 데이터베이스 항목 X의 값을 변수 X로 복사함
- Write(X), write_item(X) : 변수 X의 값을 주기억 장치 내의 데이터베이스 항목 X에 기록함

##### 동시성 제어를 하지 않는다면 생길 수 있는 문제

- lost update : 수행 중인 트랜잭션이 갱신한 내용을 다른 트랜잭션이 덮어씀
- dirty read : 완료되지 않은 트랜잭션이 갱신한 데이터를 읽음
- unrepeatable read : 한 트랜잭션이 동일한 데이터를 두 번 읽을 때 서로 다른 값을 읽음
- phantom read : 한 트랜잭션이 동일한 데이터를 두 번 읽을 때 이전에 없던 값이 나타남

##### 동시성을 제어해보자

lock과 트랜잭션 isolation level

- locking
  - shared lock (read lock)
  - exclusive lock (write lock)
- multiple granularity : 한 트랜잭션에서 lock할 수 있는 단위가 2가지 이상인 경우
  - 트랜잭션이 접근하는 투플의 수에 따라 lock을 하는 데이터 항목의 단위를 구분하는 것이 필요하다
- 2-phase locking protocol : lock 확장 단계 + lock 수축 단계
- deadlock : 두 개 이상의 트랜잭션들이 서로 상대방이 보유하고 있는 lock을 요청하면서 기다리고 있는 상태
- 

## 회복

데이터베이스에 장애가 발생했을 때 데이터베이스를 일관성 있는 상태로 되돌리는 DBMS 기능

<img src="/Users/jiwon/Library/Application Support/typora-user-images/스크린샷 2020-06-19 오전 8.19.09.png" alt="스크린샷 2020-06-19 오전 8.19.09" style="zoom:70%;" />

- 로그기반 회복기법
  - 이중 로그 : 두 개의 디스크에 중복 저장
  - 로그 레코드 : 데이터베이스 항목에 영향을 미치는 모든 트랜잭션의 연산들에 대해 로그 레코드 기록(LSN으로 식별)
  - WAL (Write-Ahead Logging) 로그 먼저 쓰기 : 로그 버퍼를 데이터베이스 버퍼보다 먼저 디스크에 기록해야 함
  1. 즉시 갱신 방법 (immediate update)
    - 트랜잭션이 수행 도중 발생하는 변경 내용을 즉시 데이터베이스에 반영. 회복할 땐 Undo 실행
  2. 지연 갱신 방법 (defered update)
    - 트랜잭션이 갱신한 내용을 트랜잭션 전체가 완료될 때에 버퍼나 디스크에 반영

- 체크포인트 기반 회복
  - DBMS는 어떤 트랜잭션의 update가 주기억 장치 버퍼로부터 디스크에 기록되었는지 알 수 없다.
  - DBMS는 회복시 재수행할 트랜잭션의 수를 줄이기 위해 주기적으로 체크포인트를 수행함. 이 때 주기억 장치의 버퍼 내용을 디스크에 기록
